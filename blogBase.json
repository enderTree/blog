{"singlePage": [], "startSite": "", "filingNum": "", "onePageListNum": 15, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "themeMode": "manual", "dayTheme": "light", "nightTheme": "dark", "urlMode": "pinyin", "script": "", "style": "", "head": "", "indexScript": "", "indexStyle": "", "bottomText": "", "showPostSource": 1, "iconList": {}, "UTC": 8, "rssSplit": "sentence", "exlink": {}, "needComment": 1, "allHead": "", "title": "ender'Blog", "subTitle": "\u95ed\u5173", "avatarUrl": "https://github.githubassets.com/favicons/favicon.svg", "GMEEK_VERSION": "last", "postListJson": {"P1": {"htmlDir": "docs/post/test.html", "labels": ["sql"], "postTitle": "test", "postUrl": "post/test.html", "postSourceUrl": "https://github.com/enderTree/blog/issues/1", "commentNum": 0, "wordCount": 518, "description": "```sql\n\nSELECT\n    *\nFROM\n(\n\n    SELECT\n        tag,\n        doc_cnt,\n        (doc_cnt/SUM(doc_cnt) OVER())*100\n    FROM\n    (\n        SELECT \n            tag,\n            SUM(doc_cnt) AS doc_cnt\n        FROM\n            dwd_crawler_host_classification_di a\n        LEFT ANTI JOIN \n            tmp_gumu_data_0624_2 b\n            ON a.host = b.host\n        WHERE\n            ymd = '2025-06-23'\n            AND tag_type = 'topic'\n        GROUP BY \n            tag\n    )\n)\nWHERE \n    tag = 'Advertising_&_Marketing'\n;\n```\u3002", "top": 0, "createdAt": 1750819859, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-06-25", "dateLabelColor": "#0969da"}, "P2": {"htmlDir": "docs/post/chuang-kou-han-shu-de-yi-xie-shi-yong.html", "labels": ["sql"], "postTitle": "\u7a97\u53e3\u51fd\u6570\u7684\u4e00\u4e9b\u4f7f\u7528", "postUrl": "post/chuang-kou-han-shu-de-yi-xie-shi-yong.html", "postSourceUrl": "https://github.com/enderTree/blog/issues/2", "commentNum": 0, "wordCount": 452, "description": "#### 1. \u53d6\u6700\u8fd1\u4e00\u4e2a\u4e0d\u4e3a\u7a7a\u7684\u503c\u586b\u5145\n```sql\nWITH mian_data AS (\n    SELECT\n        c0,\n        c1,\n        IF(c1 = '\u5904\u7f6e', NULL, c2) AS c2\n    FROM\n        VALUES\n         (1,'\u5904\u7f6e','1')\n        ,(2,'\u5904\u7f6e','2')\n        ,(3,'\u5904\u7f6e','3')\n        ,(4,'\u5904\u7f6e','4')\n        ,(5,'\u63d0\u4ea4','A')\n        ,(6,'\u5904\u7f6e','5')\n        ,(7,'\u63d0\u4ea4','b')\n    AS a(c0,c1,c2)\n)\nSELECT \n    *,\n    FIRST_VALUE(c2, True) over(order by c0 ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\nFROM \n    mian_data \n```\u3002", "top": 0, "createdAt": 1750822716, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-06-25", "dateLabelColor": "#0969da"}, "P3": {"htmlDir": "docs/post/jie-jue-Join-shu-ju-qing-xie.html", "labels": ["sql"], "postTitle": "\u89e3\u51b3Join\u6570\u636e\u503e\u659c", "postUrl": "post/jie-jue-Join-shu-ju-qing-xie.html", "postSourceUrl": "https://github.com/enderTree/blog/issues/3", "commentNum": 0, "wordCount": 1836, "description": "\u4f18\u5316\u524d\uff1a\n```sql\nSELECT \n        /*+ mapjoin(dd),skewjoin(a(url))*/\n        a.* except(url_tag, join_key),\n        CASE \n            WHEN cc.url IS NOT NULL THEN 'black_url'\n            WHEN dd.url IS NOT NULL THEN 'black_url'\n            ELSE ''\n        END AS url_tag\n    FROM\n    (\n        select \n            *,\n            1 AS join_key\n        from \n            dwd_crawler_urls_step1_di a \n        where \n            ymd = '${P_DATE}'\n            AND url_tag != 'black_url'\n    ) as\n    LEFT JOIN \n        black_urls2 cc  \n        ON replace(a.host, 'www.', '') = replace(cc.url, 'www.', '')\n\tLEFT JOIN \n        black_urls1 dd  \n        ON INSTR(a.url, dd.url) > 0\n```\n\u4f18\u5316\u540e\n```sql\nSELECT \n        /*+ mapjoin(dd),skewjoin(a(url))*/\n        a.* except(url_tag, join_key),\n        CASE \n            WHEN cc.url IS NOT NULL THEN 'black_url'\n            WHEN dd.url IS NOT NULL THEN 'black_url'\n            ELSE ''\n        END AS url_tag\n    FROM\n    (\n        select \n            *,\n            1 AS join_key\n        from \n            dwd_crawler_urls_step1_di a \n        where \n            ymd = '${P_DATE}'\n            AND url_tag != 'black_url'\n    ) a\n    LEFT JOIN \n        black_urls1 dd  \n        ON INSTR(a.url, dd.url) > 0\n    LEFT JOIN \n        black_urls2 cc  \n        ON replace(a.host, 'www.', '') = replace(cc.url, 'www.', '')\n```\n\u4f18\u5316\u524d\u6267\u884c\u65f6\u95f4\n\n<img width='991' alt='Image' src='https://github.com/user-attachments/assets/3d62cdfd-b1e0-4579-adc9-a8bc19ac64ff' />\n\n<img width='872' alt='Image' src='https://github.com/user-attachments/assets/46033d2f-9fbe-4400-b6c6-489f97ee7f00' />\n\n\u4f18\u5316\u540e\u6267\u884c\u65f6\u95f4\n\n<img width='978' alt='Image' src='https://github.com/user-attachments/assets/74de5fc3-08ff-4ed6-8c94-9b0d31c18799' />\n\n<img width='944' alt='Image' src='https://github.com/user-attachments/assets/b2f397da-420d-484b-9655-3dda6ee57046' />\n\u3002", "top": 0, "createdAt": 1750822743, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-06-25", "dateLabelColor": "#0969da"}}, "singeListJson": {}, "labelColorDict": {"bug": "#d73a4a", "documentation": "#0075ca", "duplicate": "#cfd3d7", "enhancement": "#a2eeef", "good first issue": "#7057ff", "help wanted": "#008672", "invalid": "#e4e669", "question": "#d876e3", "sql": "#a3bf9d", "wontfix": "#ffffff"}, "displayTitle": "ender'Blog", "faviconUrl": "https://github.githubassets.com/favicons/favicon.svg", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "primerCSS": "<link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />", "homeUrl": "https://enderTree.github.io/blog", "prevUrl": "disabled", "nextUrl": "disabled"}